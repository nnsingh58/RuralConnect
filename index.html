<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rural Connect</title>
    <!-- React and Babel via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.20.15/babel.min.js"></script>
    <!-- TailwindCSS via CDN -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Arial', sans-serif; background: linear-gradient(to bottom, #e0f2fe, #ffffff); }
        .header { @apply sticky top-0 bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg z-10 p-4 flex justify-between items-center; }
        .category-container { @apply bg-white p-6 rounded-xl shadow-lg mb-6 border border-gray-200; }
        .service-card { @apply bg-gray-50 p-4 m-2 rounded-lg shadow-md hover:shadow-xl transition transform hover:-translate-y-1; }
        .banner { @apply bg-gradient-to-r from-green-400 to-blue-500 text-white p-6 rounded-xl mb-6 font-semibold; }
        .language-toggle { @apply bg-indigo-700 text-white px-4 py-2 rounded-lg hover:bg-indigo-800 transition; }
        .chatbot { @apply fixed bottom-6 right-6 bg-blue-600 text-white p-4 rounded-full shadow-xl hover:bg-blue-700 transition; }
        .error-message { @apply text-red-600 p-4 text-center font-medium; }
        .main-content { @apply p-6; }
        .services-overview { @apply bg-gray-100 p-6 rounded-xl mb-6; }
        .footer { @apply bg-gray-800 text-white p-6 mt-6; }
        .form-input { @apply w-full p-3 mb-4 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500; }
        .form-button { @apply p-3 rounded-lg text-white w-full transition; }
        .table-container { @apply bg-white p-6 rounded-xl shadow-lg mb-6; }
        .status-pending { @apply text-yellow-600; }
        .status-accepted { @apply text-blue-600; }
        .status-completed { @apply text-green-600; }
        .status-dismissed { @apply text-red-600; }
        .seeker-button { @apply bg-blue-600 hover:bg-blue-700; }
        .provider-button { @apply bg-green-600 hover:bg-green-700; }
        .admin-button { @apply bg-purple-600 hover:bg-purple-700; }
        .logout-button { @apply bg-red-600 hover:bg-red-700; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        // Mock Backend (Local Storage)
        const saveUser = (user) => {
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            users.push(user);
            localStorage.setItem('users', JSON.stringify(users));
        };

        const getUsers = () => JSON.parse(localStorage.getItem('users') || '[]');

        const saveBooking = (booking) => {
            const bookings = JSON.parse(localStorage.getItem('bookings') || '[]');
            bookings.push(booking);
            localStorage.setItem('bookings', JSON.stringify(bookings));
        };

        const getBookings = () => JSON.parse(localStorage.getItem('bookings') || '[]');

        const saveProvider = (provider) => {
            const providers = JSON.parse(localStorage.getItem('providers') || '[]');
            providers.push({ ...provider, status: 'pending', availability: 'available', ratings: [] });
            localStorage.setItem('providers', JSON.stringify(providers));
        };

        const getProviders = () => JSON.parse(localStorage.getItem('providers') || '[]');

        const updateProviderStatus = (phone, status) => {
            const providers = getProviders();
            const updated = providers.map(p => p.phone === phone ? { ...p, status } : p);
            localStorage.setItem('providers', JSON.stringify(updated));
        };

        const updateBookingStatus = (id, status, providerPhone = null, timeEstimate = null) => {
            const bookings = getBookings();
            const updated = bookings.map(b => b.id === id ? { ...b, status, providerPhone, timeEstimate } : b);
            localStorage.setItem('bookings', JSON.stringify(updated));
        };

        const addRating = (providerPhone, rating) => {
            const providers = getProviders();
            const updated = providers.map(p => p.phone === providerPhone ? { ...p, ratings: [...(p.ratings || []), rating] } : p);
            localStorage.setItem('providers', JSON.stringify(updated));
        };

        // Simple Router
        function Router({ children }) {
            const [path, setPath] = useState(window.location.pathname);
            useEffect(() => {
                const onPopState = () => setPath(window.location.pathname);
                window.addEventListener('popstate', onPopState);
                return () => window.removeEventListener('popstate', onPopState);
            }, []);
            return children.find(child => child.props.path === path) || children.find(child => child.props.path === '/');
        }

        function Route({ path, component: Component }) {
            return <Component />;
        }

        function navigate(path) {
            window.history.pushState({}, '', path);
            window.dispatchEvent(new PopStateEvent('popstate'));
        }

        // Main App Component
        function App() {
            const [user, setUser] = useState(null);
            const [language, setLanguage] = useState('en');
            const [notifications, setNotifications] = useState([]);

            const toggleLanguage = () => setLanguage(language === 'en' ? 'hi' : 'en');

            const addNotification = (message) => {
                setNotifications([...notifications, message]);
                setTimeout(() => setNotifications(n => n.slice(1)), 5000);
            };

            return (
                <Router>
                    <Route path="/" component={() => (
                        <LoginScreen 
                            setUser={setUser} 
                            language={language} 
                            toggleLanguage={toggleLanguage} 
                            addNotification={addNotification} 
                        />
                    )} />
                    <Route path="/seeker" component={() => (
                        user && user.role === 'seeker' ? (
                            <SeekerDashboard 
                                user={user} 
                                setUser={setUser} 
                                language={language} 
                                toggleLanguage={toggleLanguage} 
                                addNotification={addNotification} 
                            />
                        ) : (
                            <div className="error-message">
                                {language === 'en' ? 'Please log in as a seeker.' : 'कृपया ग्राहक के रूप में लॉग इन करें।'}
                            </div>
                        )
                    )} />
                    <Route path="/provider" component={() => (
                        user && user.role === 'provider' ? (
                            <ProviderDashboard 
                                user={user} 
                                setUser={setUser} 
                                language={language} 
                                toggleLanguage={toggleLanguage} 
                                addNotification={addNotification} 
                            />
                        ) : (
                            <div className="error-message">
                                {language === 'en' ? 'Please log in as a provider.' : 'कृपया सेवा प्रदाता के रूप में लॉग इन करें।'}
                            </div>
                        )
                    )} />
                    <Route path="/admin" component={() => (
                        user && user.role === 'admin' ? (
                            <AdminDashboard 
                                user={user} 
                                setUser={setUser} 
                                language={language} 
                                toggleLanguage={toggleLanguage} 
                                addNotification={addNotification} 
                            />
                        ) : (
                            <div className="error-message">
                                {language === 'en' ? 'Please log in as an admin.' : 'कृपया प्रशासक के रूप में लॉग इन करें।'}
                            </div>
                        )
                    )} />
                </Router>
            );
        }

        // Login Screen
        function LoginScreen({ setUser, language, toggleLanguage, addNotification }) {
            const [role, setRole] = useState('seeker');
            const [emailOrPhone, setEmailOrPhone] = useState('');
            const [password, setPassword] = useState('');
            const [isSignup, setIsSignup] = useState(false);
            const [name, setName] = useState('');
            const [address, setAddress] = useState('');

            const handleLogin = () => {
                const users = getUsers();
                const user = users.find(u => u.emailOrPhone === emailOrPhone && u.password === password && u.role === role);
                if (user) {
                    setUser(user);
                    navigate(`/${role}`);
                    addNotification(language === 'en' ? 'Logged in successfully!' : 'सफलतापूर्वक लॉग इन किया गया!');
                } else {
                    alert(language === 'en' ? 'Invalid credentials.' : 'अमान्य क्रेडेंशियल।');
                }
            };

            const handleSignup = () => {
                if (!name || !emailOrPhone || !password || !address) {
                    alert(language === 'en' ? 'Please fill all fields.' : 'कृपया सभी क्षेत्र भरें।');
                    return;
                }
                const users = getUsers();
                if (users.some(u => u.emailOrPhone === emailOrPhone)) {
                    alert(language === 'en' ? 'User already exists.' : 'उपयोगकर्ता पहले से मौजूद है।');
                    return;
                }
                const user = { name, emailOrPhone, password, address, role };
                saveUser(user);
                setUser(user);
                navigate(`/${role}`);
                addNotification(language === 'en' ? 'Signed up successfully!' : 'सफलतापूर्वक साइन अप किया गया!');
            };

            return (
                <div className="min-h-screen">
                    <div className="header">
                        <h1 className="text-xl font-bold">Rural Connect</h1>
                        <button onClick={toggleLanguage} className="language-toggle">
                            {language === 'en' ? 'हिन्दी' : 'English'}
                        </button>
                    </div>
                    <div className="main-content max-w-md mx-auto">
                        <h2 className="text-2xl font-bold mb-4">
                            {language === 'en' ? (isSignup ? 'Sign Up' : 'Login') : (isSignup ? 'साइन अप' : 'लॉगिन')}
                        </h2>
                        <select
                            value={role}
                            onChange={(e) => setRole(e.target.value)}
                            className="form-input mb-4"
                        >
                            <option value="seeker">{language === 'en' ? 'Seeker' : 'ग्राहक'}</option>
                            <option value="provider">{language === 'en' ? 'Provider' : 'सेवा प्रदाता'}</option>
                            <option value="admin">{language === 'en' ? 'Admin' : 'प्रशासक'}</option>
                        </select>
                        {isSignup && (
                            <>
                                <input
                                    type="text"
                                    placeholder={language === 'en' ? 'Full Name' : 'पूरा नाम'}
                                    value={name}
                                    onChange={(e) => setName(e.target.value)}
                                    className="form-input"
                                />
                                <input
                                    type="text"
                                    placeholder={language === 'en' ? 'Address' : 'पता'}
                                    value={address}
                                    onChange={(e) => setAddress(e.target.value)}
                                    className="form-input"
                                />
                            </>
                        )}
                        <input
                            type="text"
                            placeholder={language === 'en' ? 'Email or Phone' : 'ईमेल या फोन'}
                            value={emailOrPhone}
                            onChange={(e) => setEmailOrPhone(e.target.value)}
                            className="form-input"
                        />
                        <input
                            type="password"
                            placeholder={language === 'en' ? 'Password' : 'पासवर्ड'}
                            value={password}
                            onChange={(e) => setPassword(e.target.value)}
                            className="form-input"
                        />
                        <button
                            onClick={isSignup ? handleSignup : handleLogin}
                            className={`form-button ${role === 'seeker' ? 'seeker-button' : role === 'provider' ? 'provider-button' : 'admin-button'}`}
                        >
                            {language === 'en' ? (isSignup ? 'Sign Up' : 'Login') : (isSignup ? 'साइन अप' : 'लॉगिन')}
                        </button>
                        <button
                            onClick={() => setIsSignup(!isSignup)}
                            className="text-blue-600 mt-4 hover:underline"
                        >
                            {language === 'en' 
                                ? (isSignup ? 'Already have an account? Login' : 'Need an account? Sign Up') 
                                : (isSignup ? 'पहले से खाता है? लॉगिन करें' : 'खाता चाहिए? साइन अप करें')}
                        </button>
                    </div>
                </div>
            );
        }

        // Seeker Dashboard
        function SeekerDashboard({ user, setUser, language, toggleLanguage, addNotification }) {
            const [searchQuery, setSearchQuery] = useState('');
            const categories = [
                { name: language === 'en' ? 'Home Appliance Repair' : 'घरेलू उपकरण मरम्मत', icon: '🔧', services: ['Fridge Repair', 'AC Repair', 'Washing Machine Repair'] },
                { name: language === 'en' ? 'Construction' : 'निर्माण', icon: '🏠', services: ['Plumber', 'Mason', 'Painter'] },
                { name: language === 'en' ? 'Rural Services' : 'ग्रामीण सेवाएँ', icon: '🚜', services: ['Tractor Mechanic', 'Livestock Care'] }
            ];

            const handleBookNow = (service) => {
                window.location.href = `booking-form.html?service=${encodeURIComponent(service)}`;
            };

            const bookings = getBookings().filter(b => b.phone === user.emailOrPhone);

            return (
                <div className="min-h-screen">
                    <div className="header">
                        <h1 className="text-xl font-bold">{language === 'en' ? 'Seeker Dashboard' : 'ग्राहक डैशबोर्ड'}</h1>
                        <div className="flex gap-2">
                            <button onClick={toggleLanguage} className="language-toggle">
                                {language === 'en' ? 'हिन्दी' : 'English'}
                            </button>
                            <button onClick={() => { setUser(null); navigate('/'); }} className="form-button logout-button">
                                {language === 'en' ? 'Logout' : 'लॉगआउट'}
                            </button>
                        </div>
                    </div>
                    <div className="main-content">
                        <ServicesOverview language={language} />
                        {notifications.map((n, i) => (
                            <div key={i} className="bg-blue-100 text-blue-800 p-2 mb-2 rounded">{n}</div>
                        ))}
                        <div className="banner">{language === 'en' ? 'Special Offer: 10% OFF!' : 'विशेष ऑफर: 10% छूट!'}</div>
                        <input
                            type="text"
                            placeholder={language === 'en' ? 'Search services...' : 'सेवाएँ खोजें...'}
                            value={searchQuery}
                            onChange={(e) => setSearchQuery(e.target.value)}
                            className="form-input"
                        />
                        {categories.map(category => (
                            <div key={category.name} className="category-container">
                                <h3 className="text-xl font-bold mb-2">{category.icon} {category.name}</h3>
                                <div className="grid grid-cols-2 md:grid-cols-3 gap-2">
                                    {category.services
                                        .filter(service => service.toLowerCase().includes(searchQuery.toLowerCase()))
                                        .map(service => (
                                            <div key={service} className="service-card">
                                                <p className="font-medium">{service}</p>
                                                <button
                                                    onClick={() => handleBookNow(service)}
                                                    className="form-button seeker-button mt-2"
                                                >
                                                    {language === 'en' ? 'Book Now' : 'अभी बुक करें'}
                                                </button>
                                            </div>
                                        ))}
                                </div>
                            </div>
                        ))}
                        <div className="table-container">
                            <h3 className="text-xl font-bold mb-4">{language === 'en' ? 'Booking History' : 'बुकिंग इतिहास'}</h3>
                            {bookings.length === 0 ? (
                                <p>{language === 'en' ? 'No bookings yet.' : 'अभी तक कोई बुकिंग नहीं।'}</p>
                            ) : (
                                <table className="w-full border-collapse">
                                    <thead>
                                        <tr className="bg-gray-200">
                                            <th className="p-2">{language === 'en' ? 'Service' : 'सेवा'}</th>
                                            <th className="p-2">{language === 'en' ? 'Status' : 'स्थिति'}</th>
                                            <th className="p-2">{language === 'en' ? 'Provider' : 'प्रदाता'}</th>
                                            <th className="p-2">{language === 'en' ? 'Time Estimate' : 'समय अनुमान'}</th>
                                            <th className="p-2">{language === 'en' ? 'Rating' : 'रेटिंग'}</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {bookings.map(booking => {
                                            const provider = getProviders().find(p => p.phone === booking.providerPhone);
                                            return (
                                                <tr key={booking.id} className="border-b">
                                                    <td className="p-2">{booking.service}</td>
                                                    <td className={`p-2 status-${booking.status}`}>{booking.status}</td>
                                                    <td className="p-2">{provider ? provider.name : 'Not Assigned'}</td>
                                                    <td className="p-2">{booking.timeEstimate || 'N/A'}</td>
                                                    <td className="p-2">
                                                        {booking.status === 'completed' && (
                                                            <select
                                                                onChange={(e) => {
                                                                    addRating(booking.providerPhone, parseInt(e.target.value));
                                                                    addNotification(language === 'en' ? 'Rating submitted!' : 'रेटिंग सबमिट की गई!');
                                                                }}
                                                                className="p-1 border rounded"
                                                            >
                                                                <option value="">{language === 'en' ? 'Rate' : 'रेट करें'}</option>
                                                                {[1, 2, 3, 4, 5].map(n => (
                                                                    <option key={n} value={n}>{n} ★</option>
                                                                ))}
                                                            </select>
                                                        )}
                                                    </td>
                                                </tr>
                                            );
                                        })}
                                    </tbody>
                                </table>
                            )}
                        </div>
                        <Chatbot language={language} />
                        <Footer language={language} />
                    </div>
                </div>
            );
        }

        // Provider Dashboard
        function ProviderDashboard({ user, setUser, language, toggleLanguage, addNotification }) {
            const [formData, setFormData] = useState({ name: '', phone: '', address: '', skills: [] });
            const [isRegistered, setIsRegistered] = useState(getProviders().some(p => p.phone === user.emailOrPhone));
            const [availability, setAvailability] = useState('available');
            const skillsList = ['Fridge Repair', 'Plumber', 'Electrician', 'Mason', 'Tractor Mechanic'];

            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setFormData({ ...formData, [name]: value });
            };

            const handleSkillChange = (skill) => {
                const skills = formData.skills.includes(skill)
                    ? formData.skills.filter(s => s !== skill)
                    : [...formData.skills, skill];
                setFormData({ ...formData, skills });
            };

            const handleRegister = () => {
                if (!formData.name || !formData.phone || !formData.address || formData.skills.length === 0) {
                    alert(language === 'en' ? 'Please fill all fields and select at least one skill.' : 'कृपया सभी क्षेत्र भरें और कम से कम एक कौशल चुनें।');
                    return;
                }
                saveProvider({ ...formData, phone: formData.phone });
                setIsRegistered(true);
                addNotification(language === 'en' ? 'Registration submitted! Awaiting admin approval.' : 'पंजीकरण सबमिट किया गया! व्यवस्थापक अनुमोदन की प्रतीक्षा है।');
            };

            const bookings = getBookings().filter(b => b.providerPhone === user.emailOrPhone);

            return (
                <div className="min-h-screen">
                    <div className="header">
                        <h1 className="text-xl font-bold">{language === 'en' ? 'Provider Dashboard' : 'सेवा प्रदाता डैशबोर्ड'}</h1>
                        <div className="flex gap-2">
                            <button onClick={toggleLanguage} className="language-toggle">
                                {language === 'en' ? 'हिन्दी' : 'English'}
                            </button>
                            <button onClick={() => { setUser(null); navigate('/'); }} className="form-button logout-button">
                                {language === 'en' ? 'Logout' : 'लॉगआउट'}
                            </button>
                        </div>
                    </div>
                    <div className="main-content">
                        {notifications.map((n, i) => (
                            <div key={i} className="bg-blue-100 text-blue-800 p-2 mb-2 rounded">{n}</div>
                        ))}
                        {!isRegistered ? (
                            <div className="category-container">
                                <h2 className="text-2xl font-bold mb-4">{language === 'en' ? 'Register as Provider' : 'सेवा प्रदाता के रूप में पंजीकरण करें'}</h2>
                                <input
                                    type="text"
                                    name="name"
                                    placeholder={language === 'en' ? 'Full Name' : 'पूरा नाम'}
                                    value={formData.name}
                                    onChange={handleInputChange}
                                    className="form-input"
                                />
                                <input
                                    type="text"
                                    name="phone"
                                    placeholder={language === 'en' ? 'Phone Number' : 'फोन नंबर'}
                                    value={formData.phone}
                                    onChange={handleInputChange}
                                    className="form-input"
                                />
                                <input
                                    type="text"
                                    name="address"
                                    placeholder={language === 'en' ? 'Address' : 'पता'}
                                    value={formData.address}
                                    onChange={handleInputChange}
                                    className="form-input"
                                />
                                <h3 className="text-lg font-semibold mb-2">{language === 'en' ? 'Select Skills' : 'कौशल चुनें'}</h3>
                                <div className="grid grid-cols-2 gap-2 mb-4">
                                    {skillsList.map(skill => (
                                        <label key={skill} className="flex items-center">
                                            <input
                                                type="checkbox"
                                                checked={formData.skills.includes(skill)}
                                                onChange={() => handleSkillChange(skill)}
                                                className="mr-2"
                                            />
                                            {skill}
                                        </label>
                                    ))}
                                </div>
                                <button onClick={handleRegister} className="form-button provider-button">
                                    {language === 'en' ? 'Register Now' : 'अभी पंजीकरण करें'}
                                </button>
                            </div>
                        ) : (
                            <div>
                                <div className="category-container">
                                    <h2 className="text-2xl font-bold mb-4">{language === 'en' ? 'Provider Status' : 'प्रदाता स्थिति'}</h2>
                                    <p className="text-green-600">
                                        {language === 'en' ? 'Registration pending approval.' : 'पंजीकरण अनुमोदन के लिए लंबित है।'}
                                    </p>
                                    <label className="flex items-center mt-4">
                                        <span className="mr-2">{language === 'en' ? 'Availability' : 'उपलब्धता'}</span>
                                        <select
                                            value={availability}
                                            onChange={(e) => setAvailability(e.target.value)}
                                            className="p-2 border rounded"
                                        >
                                            <option value="available">{language === 'en' ? 'Available' : 'उपलब्ध'}</option>
                                            <option value="busy">{language === 'en' ? 'Busy' : 'व्यस्त'}</option>
                                        </select>
                                    </label>
                                </div>
                                <div className="table-container">
                                    <h3 className="text-xl font-bold mb-4">{language === 'en' ? 'Assigned Bookings' : 'आवंटित बुकिंग्स'}</h3>
                                    {bookings.length === 0 ? (
                                        <p>{language === 'en' ? 'No bookings assigned.' : 'कोई बुकिंग आवंटित नहीं।'}</p>
                                    ) : (
                                        <table className="w-full border-collapse">
                                            <thead>
                                                <tr className="bg-gray-200">
                                                    <th className="p-2">{language === 'en' ? 'Service' : 'सेवा'}</th>
                                                    <th className="p-2">{language === 'en' ? 'Customer' : 'ग्राहक'}</th>
                                                    <th className="p-2">{language === 'en' ? 'Status' : 'स्थिति'}</th>
                                                    <th className="p-2">{language === 'en' ? 'Actions' : 'कार्रवाइयाँ'}</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {bookings.map(booking => (
                                                    <tr key={booking.id} className="border-b">
                                                        <td className="p-2">{booking.service}</td>
                                                        <td className="p-2">{booking.name}</td>
                                                        <td className={`p-2 status-${booking.status}`}>{booking.status}</td>
                                                        <td className="p-2">
                                                            {booking.status === 'pending' && (
                                                                <div className="flex gap-2">
                                                                    <button
                                                                        onClick={() => {
                                                                            const timeEstimate = prompt(language === 'en' ? 'Enter time estimate (e.g., 2 hours)' : 'समय अनुमान दर्ज करें (उदाहरण: 2 घंटे)');
                                                                            if (timeEstimate) {
                                                                                updateBookingStatus(booking.id, 'accepted', user.emailOrPhone, timeEstimate);
                                                                                addNotification(language === 'en' ? `Accepted ${booking.service}` : `${booking.service} स्वीकार किया गया`);
                                                                            }
                                                                        }}
                                                                        className="form-button provider-button p-1"
                                                                    >
                                                                        {language === 'en' ? 'Accept' : 'स्वीकार करें'}
                                                                    </button>
                                                                    <button
                                                                        onClick={() => {
                                                                            updateBookingStatus(booking.id, 'dismissed');
                                                                            addNotification(language === 'en' ? `Dismissed ${booking.service}` : `${booking.service} खारिज किया गया`);
                                                                        }}
                                                                        className="form-button logout-button p-1"
                                                                    >
                                                                        {language === 'en' ? 'Dismiss' : 'खारिज करें'}
                                                                    </button>
                                                                </div>
                                                            )}
                                                            {booking.status === 'accepted' && (
                                                                <button
                                                                    onClick={() => {
                                                                        updateBookingStatus(booking.id, 'completed');
                                                                        addNotification(language === 'en' ? `Completed ${booking.service}` : `${booking.service} पूरा हुआ`);
                                                                    }}
                                                                    className="form-button provider-button p-1"
                                                                >
                                                                    {language === 'en' ? 'Mark Completed' : 'पूरा हुआ चिह्नित करें'}
                                                                </button>
                                                            )}
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    )}
                                </div>
                            </div>
                        )}
                        <Chatbot language={language} />
                        <Footer language={language} />
                    </div>
                </div>
            );
        }

        // Admin Dashboard
        function AdminDashboard({ user, setUser, language, toggleLanguage, addNotification }) {
            const providers = getProviders();
            const bookings = getBookings();

            const handleApproval = (phone, status) => {
                updateProviderStatus(phone, status);
                addNotification(language === 'en' 
                    ? `Provider ${status === 'approved' ? 'approved' : 'rejected'}!` 
                    : `प्रदाता ${status === 'approved' ? 'स्वीकृत' : 'अस्वीकृत'}!`);
            };

            const handleComplaint = (bookingId, action) => {
                const booking = bookings.find(b => b.id === bookingId);
                if (action === 'accept') {
                    const timeEstimate = prompt(language === 'en' ? 'Enter time estimate for resolution' : 'समाधान के लिए समय अनुमान दर्ज करें');
                    if (timeEstimate) {
                        updateBookingStatus(bookingId, 'accepted', booking.providerPhone, timeEstimate);
                        addNotification(language === 'en' 
                            ? `Complaint for ${booking.service} accepted` 
                            : `${booking.service} की शिकायत स्वीकार की गई`);
                    }
                } else {
                    updateBookingStatus(bookingId, 'dismissed');
                    addNotification(language === 'en' 
                        ? `Complaint for ${booking.service} dismissed` 
                        : `${booking.service} की शिकायत खारिज की गई`);
                }
            };

            return (
                <div className="min-h-screen">
                    <div className="header">
                        <h1 className="text-xl font-bold">{language === 'en' ? 'Admin Dashboard' : 'प्रशासन डैशबोर्ड'}</h1>
                        <div className="flex gap-2">
                            <button onClick={toggleLanguage} className="language-toggle">
                                {language === 'en' ? 'हिन्दी' : 'English'}
                            </button>
                            <button onClick={() => { setUser(null); navigate('/'); }} className="form-button logout-button">
                                {language === 'en' ? 'Logout' : 'लॉगआउट'}
                            </button>
                        </div>
                    </div>
                    <div className="main-content">
                        {notifications.map((n, i) => (
                            <div key={i} className="bg-blue-100 text-blue-800 p-2 mb-2 rounded">{n}</div>
                        ))}
                        <div className="table-container">
                            <h3 className="text-xl font-bold mb-4">{language === 'en' ? 'Manage Providers' : 'प्रदाताओं को प्रबंधित करें'}</h3>
                            {providers.length === 0 ? (
                                <p>{language === 'en' ? 'No providers registered.' : 'कोई प्रदाता पंजीकृत नहीं।'}</p>
                            ) : (
                                <table className="w-full border-collapse">
                                    <thead>
                                        <tr className="bg-gray-200">
                                            <th className="p-2">{language === 'en' ? 'Name' : 'नाम'}</th>
                                            <th className="p-2">{language === 'en' ? 'Phone' : 'फोन'}</th>
                                            <th className="p-2">{language === 'en' ? 'Skills' : 'कौशल'}</th>
                                            <th className="p-2">{language === 'en' ? 'Status' : 'स्थिति'}</th>
                                            <th className="p-2">{language === 'en' ? 'Actions' : 'कार्रवाइयाँ'}</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {providers.map(provider => (
                                            <tr key={provider.phone} className="border-b">
                                                <td className="p-2">{provider.name}</td>
                                                <td className="p-2">{provider.phone}</td>
                                                <td className="p-2">{provider.skills.join(', ')}</td>
                                                <td className={`p-2 status-${provider.status}`}>{provider.status}</td>
                                                <td className="p-2">
                                                    {provider.status === 'pending' && (
                                                        <div className="flex gap-2">
                                                            <button
                                                                onClick={() => handleApproval(provider.phone, 'approved')}
                                                                className="form-button admin-button p-1"
                                                            >
                                                                {language === 'en' ? 'Approve' : 'स्वीकृत करें'}
                                                            </button>
                                                            <button
                                                                onClick={() => handleApproval(provider.phone, 'rejected')}
                                                                className="form-button logout-button p-1"
                                                            >
                                                                {language === 'en' ? 'Reject' : 'अस्वीकार करें'}
                                                            </button>
                                                        </div>
                                                    )}
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            )}
                        </div>
                        <div className="table-container">
                            <h3 className="text-xl font-bold mb-4">{language === 'en' ? 'Manage Bookings' : 'बुकिंग्स प्रबंधित करें'}</h3>
                            {bookings.length === 0 ? (
                                <p>{language === 'en' ? 'No bookings recorded.' : 'कोई बुकिंग दर्ज नहीं।'}</p>
                            ) : (
                                <table className="w-full border-collapse">
                                    <thead>
                                        <tr className="bg-gray-200">
                                            <th className="p-2">{language === 'en' ? 'Service' : 'सेवा'}</th>
                                            <th className="p-2">{language === 'en' ? 'Customer' : 'ग्राहक'}</th>
                                            <th className="p-2">{language === 'en' ? 'Provider' : 'प्रदाता'}</th>
                                            <th className="p-2">{language === 'en' ? 'Status' : 'स्थिति'}</th>
                                            <th className="p-2">{language === 'en' ? 'Time Estimate' : 'समय अनुमान'}</th>
                                            <th className="p-2">{language === 'en' ? 'Complaint' : 'शिकायत'}</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {bookings.map(booking => {
                                            const provider = getProviders().find(p => p.phone === booking.providerPhone);
                                            return (
                                                <tr key={booking.id} className="border-b">
                                                    <td className="p-2">{booking.service}</td>
                                                    <td className="p-2">{booking.name}</td>
                                                    <td className="p-2">{provider ? provider.name : 'Not Assigned'}</td>
                                                    <td className={`p-2 status-${booking.status}`}>{booking.status}</td>
                                                    <td className="p-2">{booking.timeEstimate || 'N/A'}</td>
                                                    <td className="p-2">
                                                        <div className="flex gap-2">
                                                            <button
                                                                onClick={() => handleComplaint(booking.id, 'accept')}
                                                                className="form-button admin-button p-1"
                                                            >
                                                                {language === 'en' ? 'Accept' : 'स्वीकार करें'}
                                                            </button>
                                                            <button
                                                                onClick={() => handleComplaint(booking.id, 'dismiss')}
                                                                className="form-button logout-button p-1"
                                                            >
                                                                {language === 'en' ? 'Dismiss' : 'खारिज करें'}
                                                            </button>
                                                        </div>
                                                    </td>
                                                </tr>
                                            );
                                        })}
                                    </tbody>
                                </table>
                            )}
                        </div>
                        <Footer language={language} />
                    </div>
                </div>
            );
        }

        // Services Overview
        function ServicesOverview({ language }) {
            return (
                <div className="services-overview">
                    <h2 className="text-2xl font-bold mb-4">{language === 'en' ? 'Our Services' : 'हमारी सेवाएँ'}</h2>
                    <p className="text-gray-700">
                        {language === 'en' 
                            ? 'Book trusted services for home, farm, and emergency needs.' 
                            : 'घर, खेत और आपातकालीन जरूरतों के लिए विश्वसनीय सेवाएँ बुक करें।'}
                    </p>
                </div>
            );
        }

        // Chatbot Component
        function Chatbot({ language }) {
            return (
                <div className="chatbot">
                    <p>{language === 'en' ? 'Chat with us!' : 'हमसे चैट करें!'}</p>
                </div>
            );
        }

        // Footer Component
        function Footer({ language }) {
            return (
                <div className="footer">
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <h3 className="text-lg font-semibold mb-2">{language === 'en' ? 'About' : 'के बारे में'}</h3>
                            <p>{language === 'en' ? 'Connecting rural communities with trusted providers.' : 'ग्रामीण समुदायों को विश्वसनीय प्रदाताओं से जोड़ना।'}</p>
                        </div>
                        <div>
                            <h3 className="text-lg font-semibold mb-2">{language === 'en' ? 'Contact' : 'संपर्क'}</h3>
                            <p>Email: support@ruralconnect.in</p>
                            <p>Phone: +91 9876543210</p>
                        </div>
                        <div>
                            <h3 className="text-lg font-semibold mb-2">{language === 'en' ? 'Links' : 'लिंक'}</h3>
                            <p><a href="#" className="hover:underline">Privacy Policy</a></p>
                            <p><a href="#" className="hover:underline">Terms of Service</a></p>
                        </div>
                    </div>
                    <p className="text-center mt-4">© 2025 Rural Connect. {language === 'en' ? 'All rights reserved.' : 'सभी अधिकार सुरक्षित।'}</p>
                </div>
            );
        }

        // Render App
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

        // Service Worker
        if ('serviceWorker' in navigator && window.location.protocol === 'https:') {
            navigator.serviceWorker.register('/sw.js')
                .then(() => console.log('Service Worker Registered'))
                .catch((error) => console.log('Service Worker Registration Failed:', error));
        }
    </script>
</body>
</html>
